const loadCssInternal = (location, isCobrand = false) => {
    const head = document.getElementsByTagName('head')[0];
    const styles = document.createElement('link');
    const className = isCobrand ? 'cobrand-style' : 'newfile-style';

    styles.href = location;
    styles.rel = 'stylesheet';
    styles.className = className;

    return new Promise((resolve) => {
        if (styles.addEventListener) {
            styles.addEventListener('load', () => {
                resolve(className);
            }, false);
        }

        const cobrandStyles = document.querySelector('.cobrand-style');
        const newFileStyles = document.querySelector('.newfile-style');

        if (isCobrand) {
            if (cobrandStyles) {
                cobrandStyles.replaceWith(styles); // Replace existing cobrandStyles
            } else {
                head.appendChild(styles); // Append cobrandStyles at the end
            }
        } else if (newFileStyles) {
            newFileStyles.replaceWith(styles); // Replace existing newFileStyles
        } else if (cobrandStyles) {
            cobrandStyles.before(styles); // Insert newFile before cobrandStyles
        } else {
            head.appendChild(styles); // Append at the end if no cobrandStyles
        }
    });
};
